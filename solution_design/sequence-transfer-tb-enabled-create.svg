<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="2106px" preserveAspectRatio="none" style="width:1902px;height:2106px;background:#FFFFFF;" version="1.1" viewBox="0 0 1902 2106" width="1902px" zoomAndPan="magnify"><defs/><g><rect fill="#FFFFF9" height="2087.6875" style="stroke:#181818;stroke-width:0.5;" width="724.5" x="342" y="6"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="113" x="645.25" y="18.0669">Central-Ledger</text><rect fill="#F9FFF9" height="2087.6875" style="stroke:#181818;stroke-width:0.5;" width="580.5" x="1299" y="6"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="61" x="1556.25" y="18.0669">Storage</text><rect height="1670.7656" style="stroke:#000000;stroke-width:1.5;fill:none;" width="1875.5" x="10" y="340.625"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="87" x2="87" y1="87.4297" y2="2028.3906"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="366" x2="366" y1="87.4297" y2="2028.3906"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="570" x2="570" y1="87.4297" y2="2028.3906"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="763.5" x2="763.5" y1="87.4297" y2="2028.3906"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="997.5" x2="997.5" y1="87.4297" y2="2028.3906"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="1372" x2="1372" y1="87.4297" y2="2028.3906"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="1603" x2="1603" y1="87.4297" y2="2028.3906"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="1765.5" x2="1765.5" y1="87.4297" y2="2028.3906"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="1852.5" x2="1852.5" y1="87.4297" y2="2028.3906"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="128" x="20" y="84.1279">Mojaloop Adapter</text><ellipse cx="87" cy="55.1328" fill="#E2E2F0" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="75" x2="99" y1="69.1328" y2="69.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="128" x="20" y="2040.3857">Mojaloop Adapter</text><ellipse cx="87" cy="2059.6875" fill="#E2E2F0" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="75" x2="99" y1="2073.6875" y2="2073.6875"/><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="40" x="346" y="56.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="26" x="353" y="76.1279">API</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="40" x="346" y="2027.3906"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="26" x="353" y="2047.3857">API</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="104" x="518" y="56.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="22" x="525" y="76.1279">api</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="64" x="551" y="76.1279">/ Handler</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="104" x="518" y="2027.3906"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="22" x="525" y="2047.3857">api</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="64" x="551" y="2047.3857">/ Handler</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="133" x="697.5" y="56.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="53" x="704.5" y="76.1279">domain</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="62" x="761.5" y="76.1279">/ Service</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="133" x="697.5" y="2027.3906"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="53" x="704.5" y="2047.3857">domain</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="62" x="761.5" y="2047.3857">/ Service</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="129" x="933.5" y="56.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="52" x="940.5" y="76.1279">models</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59" x="996.5" y="76.1279">/ Facade</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="129" x="933.5" y="2027.3906"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="52" x="940.5" y="2047.3857">models</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59" x="996.5" y="2047.3857">/ Facade</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="132" x="1303" y="84.1279">TigerBeetle Client</text><ellipse cx="1372" cy="55.1328" fill="#E2E2F0" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><polygon fill="#181818" points="1368,43.1328,1374,38.1328,1372,43.1328,1374,48.1328,1368,43.1328" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="132" x="1303" y="2040.3857">TigerBeetle Client</text><ellipse cx="1372" cy="2059.6875" fill="#E2E2F0" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><polygon fill="#181818" points="1368,2047.6875,1374,2042.6875,1372,2047.6875,1374,2052.6875,1368,2047.6875" style="stroke:#181818;stroke-width:1.0;"/><rect fill="#E2E2F0" height="30.2969" style="stroke:#181818;stroke-width:0.5;" width="154" x="1528" y="52.1328"/><rect fill="#E2E2F0" height="30.2969" style="stroke:#181818;stroke-width:0.5;" width="154" x="1524" y="56.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="140" x="1531" y="76.1279">TigerBeetle Cluster</text><rect fill="#E2E2F0" height="30.2969" style="stroke:#181818;stroke-width:0.5;" width="154" x="1528" y="2027.3906"/><rect fill="#E2E2F0" height="30.2969" style="stroke:#181818;stroke-width:0.5;" width="154" x="1524" y="2031.3906"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="140" x="1531" y="2051.3857">TigerBeetle Cluster</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="103" x="1711.5" y="84.1279">central-ledger</text><path d="M1748,35.1328 C1748,25.1328 1766,25.1328 1766,25.1328 C1766,25.1328 1784,25.1328 1784,35.1328 L1784,61.1328 C1784,71.1328 1766,71.1328 1766,71.1328 C1766,71.1328 1748,71.1328 1748,61.1328 L1748,35.1328 " fill="#E2E2F0" style="stroke:#181818;stroke-width:1.5;"/><path d="M1748,35.1328 C1748,45.1328 1766,45.1328 1766,45.1328 C1766,45.1328 1784,45.1328 1784,35.1328 " fill="none" style="stroke:#181818;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="103" x="1711.5" y="2040.3857">central-ledger</text><path d="M1748,2053.6875 C1748,2043.6875 1766,2043.6875 1766,2043.6875 C1766,2043.6875 1784,2043.6875 1784,2053.6875 L1784,2079.6875 C1784,2089.6875 1766,2089.6875 1766,2089.6875 C1766,2089.6875 1748,2089.6875 1748,2079.6875 L1748,2053.6875 " fill="#E2E2F0" style="stroke:#181818;stroke-width:1.5;"/><path d="M1748,2053.6875 C1748,2063.6875 1766,2063.6875 1766,2063.6875 C1766,2063.6875 1784,2063.6875 1784,2053.6875 " fill="none" style="stroke:#181818;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39" x="1830.5" y="84.1279">Redis</text><path d="M1835,35.1328 C1835,25.1328 1853,25.1328 1853,25.1328 C1853,25.1328 1871,25.1328 1871,35.1328 L1871,61.1328 C1871,71.1328 1853,71.1328 1853,71.1328 C1853,71.1328 1835,71.1328 1835,61.1328 L1835,35.1328 " fill="#E2E2F0" style="stroke:#181818;stroke-width:1.5;"/><path d="M1835,35.1328 C1835,45.1328 1853,45.1328 1853,45.1328 C1853,45.1328 1871,45.1328 1871,35.1328 " fill="none" style="stroke:#181818;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39" x="1830.5" y="2040.3857">Redis</text><path d="M1835,2053.6875 C1835,2043.6875 1853,2043.6875 1853,2043.6875 C1853,2043.6875 1871,2043.6875 1871,2053.6875 L1871,2079.6875 C1871,2089.6875 1853,2089.6875 1853,2089.6875 C1853,2089.6875 1835,2089.6875 1835,2079.6875 L1835,2053.6875 " fill="#E2E2F0" style="stroke:#181818;stroke-width:1.5;"/><path d="M1835,2053.6875 C1835,2063.6875 1853,2063.6875 1853,2063.6875 C1853,2063.6875 1871,2063.6875 1871,2053.6875 " fill="none" style="stroke:#181818;stroke-width:1.5;"/><path d="M12,102.4297 L12,142.4297 L162,142.4297 L162,112.4297 L152,102.4297 L12,102.4297 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M152,102.4297 L152,112.4297 L162,112.4297 L152,102.4297 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><ellipse cx="23.5" cy="115.0625" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="116" x="31" y="119.4966">Participant Bank A</text><ellipse cx="23.5" cy="130.1953" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="115" x="31" y="134.6294">Participant Bank B</text><path d="M263,152.6953 L263,177.6953 L468,177.6953 L468,162.6953 L458,152.6953 L263,152.6953 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M458,152.6953 L458,162.6953 L468,162.6953 L458,152.6953 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="184" x="269" y="169.7622">REST API deployed in NodeJS</text><path d="M454,187.8281 L454,227.8281 L685,227.8281 L685,197.8281 L675,187.8281 L454,187.8281 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M675,187.8281 L675,197.8281 L685,197.8281 L675,187.8281 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="171" x="460" y="204.895">JSON request decoded and</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="210" x="460" y="220.0278">sent for processing via a handler</text><path d="M648,238.0938 L648,278.0938 L879,278.0938 L879,248.0938 L869,238.0938 L648,238.0938 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M869,238.0938 L869,248.0938 L879,248.0938 L869,238.0938 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="210" x="654" y="255.1606">Domain folder where the service</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="147" x="654" y="270.2935">functions are exposed.</text><path d="M863,288.3594 L863,328.3594 L1133,328.3594 L1133,298.3594 L1123,288.3594 L863,288.3594 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1123,288.3594 L1123,298.3594 L1133,298.3594 L1123,288.3594 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="249" x="869" y="305.4263">Facade for storing/retrieving data from</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="147" x="869" y="320.5591">MySQL and TigerBeetle</text><path d="M10,340.625 L256,340.625 L256,347.7578 L246,357.7578 L10,357.7578 L10,340.625 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="1670.7656" style="stroke:#000000;stroke-width:1.5;" width="1875.5" x="10" y="340.625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="201" x="25" y="353.6919">Create Transfer (2-Phase)</text><polygon fill="#181818" points="354,390.0234,364,394.0234,354,398.0234,358,394.0234" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="87" x2="360" y1="394.0234" y2="394.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="94" y="381.3911">1</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="32" x="107" y="373.8247">JSON</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="139" y="373.8247"> </text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="116" x="107" y="388.9575">(transfer data)</text><polygon fill="#181818" points="558,434.2891,568,438.2891,558,442.2891,562,438.2891" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="366" x2="564" y1="438.2891" y2="438.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="373" y="425.6567">2</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="163" x="386" y="418.0903">/jmeter/transfers/prepare</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="549" y="418.0903"> </text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103" x="386" y="433.2231">Handler invoked</text><polygon fill="#181818" points="752,463.4219,762,467.4219,752,471.4219,756,467.4219" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="570" x2="758" y1="467.4219" y2="467.4219"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8" x="577" y="462.356">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="137" x="589" y="462.356">Service layer invoked</text><polygon fill="#181818" points="986,492.5547,996,496.5547,986,500.5547,990,496.5547" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="764" x2="992" y1="496.5547" y2="496.5547"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="771" y="491.4888">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="115" x="784" y="491.4888">Domain to facade</text><polygon fill="#181818" points="1754,627.6172,1764,631.6172,1754,635.6172,1758,631.6172" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="998" x2="1760" y1="631.6172" y2="631.6172"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="1005" y="573.5864">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="356" x="1018" y="520.6216">Perform the following validations against the database:</text><ellipse cx="1023.5" cy="531.3203" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="230" x="1031" y="535.7544">validateFspiopSourceMatchesPayer</text><ellipse cx="1023.5" cy="546.4531" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="179" x="1031" y="550.8872">validateParticipantByName</text><ellipse cx="1023.5" cy="561.5859" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="296" x="1031" y="566.02">validatePositionAccountByNameAndCurrency</text><ellipse cx="1023.5" cy="576.7188" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="179" x="1031" y="581.1528">validateParticipantByName</text><ellipse cx="1023.5" cy="591.8516" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="104" x="1031" y="596.2856">validateAmount</text><ellipse cx="1023.5" cy="606.9844" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="206" x="1031" y="611.4185">validateConditionAndExpiration</text><ellipse cx="1023.5" cy="622.1172" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="141" x="1031" y="626.5513">validateDifferentDfsp</text><polygon fill="#181818" points="1841,671.8828,1851,675.8828,1841,679.8828,1845,675.8828" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="998" x2="1847" y1="675.8828" y2="675.8828"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="1005" y="663.2505">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="171" x="1018" y="655.6841">Lookup participant data by</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="37" x="1018" y="670.8169">name</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="1055" y="670.8169">,</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="84" x="1063" y="670.8169">account type</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97" x="1151" y="670.8169">(POSITION) and</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="56" x="1252" y="670.8169">currency</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="1308" y="670.8169">.</text><polygon fill="#181818" points="1754,701.0156,1764,705.0156,1754,709.0156,1758,705.0156" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="998" x2="1760" y1="705.0156" y2="705.0156"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="504" x="1005" y="699.9497">If the participant data is not available in Redis, a database lookup is performed</text><polygon fill="#181818" points="1841,730.1484,1851,734.1484,1841,738.1484,1845,734.1484" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="998" x2="1847" y1="734.1484" y2="734.1484"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="245" x="1005" y="729.0825">Data looked up is now stored in Redis.</text><polygon fill="#181818" points="1360,759.2813,1370,763.2813,1360,767.2813,1364,763.2813" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="998" x2="1366" y1="763.2813" y2="763.2813"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="1005" y="758.2153">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="51" x="1018" y="758.2153">Pending</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="54" x="1073" y="758.2153">Transfer</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="219" x="1131" y="758.2153">requested via the CL-TB interface.</text><polygon fill="#181818" points="1591,803.5469,1601,807.5469,1591,811.5469,1595,807.5469" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1372" x2="1597" y1="807.5469" y2="807.5469"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="1379" y="794.9146">8</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="51" x="1392" y="787.3481">transfer</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130" x="1447" y="787.3481">Distributed to nodes</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="144" x="1396" y="802.481">via the state machine.</text><line style="stroke:#181818;stroke-width:1.0;" x1="1603" x2="1645" y1="836.6797" y2="836.6797"/><line style="stroke:#181818;stroke-width:1.0;" x1="1645" x2="1645" y1="836.6797" y2="849.6797"/><line style="stroke:#181818;stroke-width:1.0;" x1="1604" x2="1645" y1="849.6797" y2="849.6797"/><polygon fill="#181818" points="1614,845.6797,1604,849.6797,1614,853.6797,1610,849.6797" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="1610" y="831.6138">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127" x="1623" y="831.6138">Replication via VSR.</text><polygon fill="#181818" points="1009,874.8125,999,878.8125,1009,882.8125,1005,878.8125" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1003" x2="1371" y1="878.8125" y2="878.8125"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="1015" y="873.7466">10</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="51" x="1038" y="873.7466">transfer</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="76" x="1093" y="873.7466">create error</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="49" x="1173" y="873.7466">(none)</text><polygon fill="#181818" points="775,903.9453,765,907.9453,775,911.9453,771,907.9453" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="769" x2="997" y1="907.9453" y2="907.9453"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="781" y="902.8794">11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="83" x="803" y="902.8794">Return result</text><polygon fill="#181818" points="581,933.0781,571,937.0781,581,941.0781,577,937.0781" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="575" x2="763" y1="937.0781" y2="937.0781"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="587" y="932.0122">12</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="83" x="609" y="932.0122">Return result</text><polygon fill="#181818" points="377,962.2109,367,966.2109,377,970.2109,373,966.2109" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="371" x2="569" y1="966.2109" y2="966.2109"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17" x="383" y="961.145">13</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="83" x="404" y="961.145">Return result</text><polygon fill="#181818" points="98,991.3438,88,995.3438,98,999.3438,94,995.3438" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="92" x2="365" y1="995.3438" y2="995.3438"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="104" y="990.2778">14</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="114" x="126" y="990.2778">Return result with</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" font-weight="bold" lengthAdjust="spacing" textLength="73" x="244" y="990.2778">transferId</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1895.5" x="0" y="1023.9102"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1895.5" y1="1023.9102" y2="1023.9102"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1895.5" y1="1026.9102" y2="1026.9102"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="333" x="781.25" y="1013.3438"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="314" x="787.25" y="1029.4106">Asynchronous Database Activities START</text><polygon fill="#181818" points="1754,1078.7422,1764,1082.7422,1754,1086.7422,1758,1082.7422" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="998" x2="1760" y1="1082.7422" y2="1082.7422"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="1005" y="1070.1099">15</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="89" x="1027" y="1062.5435">[ASYNC 1.1]</text><ellipse cx="1032.5" cy="1073.2422" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="153" x="1040" y="1077.6763">transferDuplicateCheck</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120" x="1197" y="1077.6763">DB record created.</text><polygon fill="#181818" points="1754,1198.6719,1764,1202.6719,1754,1206.6719,1758,1202.6719" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="998" x2="1760" y1="1202.6719" y2="1202.6719"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="1005" y="1152.2075">16</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="89" x="1027" y="1106.8091">[ASYNC 1.2]</text><ellipse cx="1032.5" cy="1117.5078" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="51" x="1040" y="1121.9419">transfer</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="1091" y="1121.9419">,</text><ellipse cx="1032.5" cy="1132.6406" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="121" x="1040" y="1137.0747">transferParticipant</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="1161" y="1137.0747">,</text><ellipse cx="1032.5" cy="1147.7734" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="60" x="1040" y="1152.2075">ilpPacket</text><ellipse cx="1032.5" cy="1162.9063" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="134" x="1040" y="1167.3403">transferStateChange</text><ellipse cx="1032.5" cy="1178.0391" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="115" x="1040" y="1182.4731">transferExtension</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="171" x="1027" y="1197.606">Database records created.</text><polygon fill="#181818" points="1009,1242.9375,999,1246.9375,1009,1250.9375,1005,1246.9375" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1754,1242.9375,1764,1246.9375,1754,1250.9375,1758,1246.9375" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1003" x2="1760" y1="1246.9375" y2="1246.9375"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="1015" y="1234.3052">17</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="88" x="1037" y="1226.7388">[ASYNC 1.3]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="216" x="1041" y="1241.8716">Database transaction committed.</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1895.5" x="0" y="1275.5039"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1895.5" y1="1275.5039" y2="1275.5039"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1895.5" y1="1278.5039" y2="1278.5039"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="323" x="786.25" y="1264.9375"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="304" x="792.25" y="1281.0044">Asynchronous Database Activities STOP</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1895.5" x="0" y="1388.6367"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1895.5" y1="1388.6367" y2="1388.6367"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1895.5" y1="1391.6367" y2="1391.6367"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="168" x="863.75" y="1378.0703"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="149" x="869.75" y="1394.1372">Transfer Fulfilment</text><polygon fill="#181818" points="354,1443.4688,364,1447.4688,354,1451.4688,358,1447.4688" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="87" x2="360" y1="1447.4688" y2="1447.4688"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="94" y="1434.8364">18</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="32" x="116" y="1427.27">JSON</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="148" y="1427.27"> </text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="151" x="116" y="1442.4028">(fulfil transfer data with</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" font-weight="bold" lengthAdjust="spacing" textLength="73" x="271" y="1442.4028">transferId</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="5" x="344" y="1442.4028">)</text><polygon fill="#181818" points="558,1487.7344,568,1491.7344,558,1495.7344,562,1491.7344" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="366" x2="564" y1="1491.7344" y2="1491.7344"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="373" y="1479.1021">19</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="143" x="395" y="1471.5356">/jmeter/transfers/fulfil</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="538" y="1471.5356"> </text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107" x="395" y="1486.6685">Handler invoked.</text><polygon fill="#181818" points="752,1532,762,1536,752,1540,756,1536" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="570" x2="758" y1="1536" y2="1536"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="577" y="1523.3677">20</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="137" x="600" y="1515.8013">Service layer invoked</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="147" x="600" y="1530.9341">handlePayeeResponse</text><polygon fill="#181818" points="986,1576.2656,996,1580.2656,986,1584.2656,990,1580.2656" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="764" x2="992" y1="1580.2656" y2="1580.2656"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="771" y="1567.6333">21</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="115" x="793" y="1560.0669">Domain to facade</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="188" x="793" y="1575.1997">savePayeeTransferResponse</text><polygon fill="#181818" points="1754,1605.3984,1764,1609.3984,1754,1613.3984,1758,1609.3984" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="998" x2="1760" y1="1609.3984" y2="1609.3984"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="1005" y="1604.3325">22</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="264" x="1027" y="1604.3325">New Database transaction for fulfillment.</text><polygon fill="#181818" points="1754,1634.5313,1764,1638.5313,1754,1642.5313,1758,1638.5313" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="998" x2="1760" y1="1638.5313" y2="1638.5313"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17" x="1005" y="1633.4653">23</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="42" x="1026" y="1633.4653">Obtain</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" font-weight="bold" lengthAdjust="spacing" textLength="151" x="1072" y="1633.4653">settlementWindowId</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="166" x="1227" y="1633.4653">for window where state is</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="41" x="1397" y="1633.4653">OPEN</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="1438" y="1633.4653">.</text><polygon fill="#181818" points="1360,1663.6641,1370,1667.6641,1360,1671.6641,1364,1667.6641" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="998" x2="1366" y1="1667.6641" y2="1667.6641"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="1005" y="1662.5981">24</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="54" x="1027" y="1662.5981">Transfer</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="270" x="1085" y="1662.5981">posting requested via the CL-TB interface.</text><polygon fill="#181818" points="1591,1707.9297,1601,1711.9297,1591,1715.9297,1595,1711.9297" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1372" x2="1597" y1="1711.9297" y2="1711.9297"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="1379" y="1699.2974">25</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="51" x="1401" y="1691.731">transfer</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130" x="1456" y="1691.731">Distributed to nodes</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="144" x="1405" y="1706.8638">via the state machine.</text><line style="stroke:#181818;stroke-width:1.0;" x1="1603" x2="1645" y1="1741.0625" y2="1741.0625"/><line style="stroke:#181818;stroke-width:1.0;" x1="1645" x2="1645" y1="1741.0625" y2="1754.0625"/><line style="stroke:#181818;stroke-width:1.0;" x1="1604" x2="1645" y1="1754.0625" y2="1754.0625"/><polygon fill="#181818" points="1614,1750.0625,1604,1754.0625,1614,1758.0625,1610,1754.0625" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="1610" y="1735.9966">26</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127" x="1632" y="1735.9966">Replication via VSR.</text><polygon fill="#181818" points="1009,1779.1953,999,1783.1953,1009,1787.1953,1005,1783.1953" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1003" x2="1371" y1="1783.1953" y2="1783.1953"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="1015" y="1778.1294">27</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="51" x="1037" y="1778.1294">transfer</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127" x="1092" y="1778.1294">posting create error</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="49" x="1223" y="1778.1294">(none)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="1272" y="1778.1294">.</text><polygon fill="#181818" points="1754,1853.7266,1764,1857.7266,1754,1861.7266,1758,1857.7266" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="998" x2="1760" y1="1857.7266" y2="1857.7266"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="1005" y="1829.9614">28</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="43" x="1027" y="1807.2622">Create</text><ellipse cx="1032.5" cy="1817.9609" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="117" x="1040" y="1822.395">transferFulfilment</text><ellipse cx="1032.5" cy="1833.0938" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="134" x="1040" y="1837.5278">transferStateChange</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="118" x="1027" y="1852.6606">Database records.</text><polygon fill="#181818" points="1754,1882.8594,1764,1886.8594,1754,1890.8594,1758,1886.8594" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="998" x2="1760" y1="1886.8594" y2="1886.8594"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="1005" y="1881.7935">29</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="216" x="1027" y="1881.7935">Database transaction committed.</text><polygon fill="#181818" points="775,1911.9922,765,1915.9922,775,1919.9922,771,1915.9922" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="769" x2="997" y1="1915.9922" y2="1915.9922"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="781" y="1910.9263">30</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="87" x="803" y="1910.9263">Return result.</text><polygon fill="#181818" points="581,1941.125,571,1945.125,581,1949.125,577,1945.125" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="575" x2="763" y1="1945.125" y2="1945.125"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17" x="587" y="1940.0591">31</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="87" x="608" y="1940.0591">Return result.</text><polygon fill="#181818" points="377,1970.2578,367,1974.2578,377,1978.2578,373,1974.2578" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="371" x2="569" y1="1974.2578" y2="1974.2578"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17" x="383" y="1969.1919">32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="87" x="404" y="1969.1919">Return result.</text><polygon fill="#181818" points="98,1999.3906,88,2003.3906,98,2007.3906,94,2003.3906" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="92" x2="365" y1="2003.3906" y2="2003.3906"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="104" y="1998.3247">33</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="87" x="124" y="1998.3247">Return result.</text><!--MD5=[171a6274ff4f6c87c2fcd1eb5988c987]
@startuml
entity "Mojaloop Adapter" as dfsp
note over dfsp
    * Participant Bank A
    * Participant Bank B
end note

box Central-Ledger #FFFFF9
    participant "**API**" as cl_api
    participant "__api__ / Handler" as cl_handler
    participant "__domain__ / Service" as cl_domain
    participant "__models__ / Facade" as cl_facade

    note over cl_api
        REST API deployed in NodeJS
    end note

    note over cl_handler
        JSON request decoded and
        sent for processing via a handler
    end note

    note over cl_domain
        Domain folder where the service
        functions are exposed.
    end note

    note over cl_facade
        Facade for storing/retrieving data from
        MySQL and TigerBeetle
    end note
end box

box Storage #F9FFF9
	control "TigerBeetle Client" as tb_client
	collections "TigerBeetle Cluster" as tb_nodes
	database "central-ledger" as cl_db
	database "Redis" as redis_cache
end box

autonumber
group Create Transfer (2-Phase)
    dfsp -> cl_api : //JSON// \n**(transfer data)**
    cl_api -> cl_handler : ///jmeter/transfers/prepare// \nHandler invoked
    cl_handler -> cl_domain : Service layer invoked
    cl_domain -> cl_facade : Domain to facade
    cl_facade -> cl_db : Perform the following validations against the database:\n*//validateFspiopSourceMatchesPayer//\n*//validateParticipantByName//\n*//validatePositionAccountByNameAndCurrency//\n*//validateParticipantByName//\n*//validateAmount//\n*//validateConditionAndExpiration//\n*//validateDifferentDfsp//
    cl_facade -> redis_cache : Lookup participant data by \n//name//, //account type// (POSITION) and //currency//.
    autonumber stop
    cl_facade - -> cl_db : If the participant data is not available in Redis, a database lookup is performed
    cl_facade - -> redis_cache : Data looked up is now stored in Redis.
    autonumber resume
    cl_facade -> tb_client : Pending //Transfer// requested via the CL-TB interface.
    tb_client -> tb_nodes : //transfer// Distributed to nodes\n via the state machine.
    tb_nodes -> tb_nodes : Replication via VSR.
    tb_client - -> cl_facade : //transfer// create error **(none)**
    cl_facade - -> cl_domain : Return result
    cl_domain - -> cl_handler : Return result
    cl_handler - -> cl_api : Return result
    cl_api - -> dfsp : Return result with //**transferId**//
    == Asynchronous Database Activities START ==
    cl_facade -> cl_db : **[ASYNC 1.1]**\n*//transferDuplicateCheck// DB record created.
    cl_facade -> cl_db : **[ASYNC 1.2]**\n*//transfer//, \n*//transferParticipant//, \n*//ilpPacket// \n*//transferStateChange// \n*//transferExtension//\nDatabase records created.
    cl_db <- -> cl_facade : **[ASYNC 1.3]**\n Database transaction committed.
    == Asynchronous Database Activities STOP ==

||70||

    == Transfer Fulfilment ==
    dfsp -> cl_api : //JSON// \n(fulfil transfer data with //**transferId**//)
    cl_api -> cl_handler : ///jmeter/transfers/fulfil// \nHandler invoked.
    cl_handler -> cl_domain : Service layer invoked \n//handlePayeeResponse//
    cl_domain -> cl_facade : Domain to facade \n//savePayeeTransferResponse//
    cl_facade -> cl_db : New Database transaction for fulfillment.
    cl_facade -> cl_db : Obtain //**settlementWindowId**// for window where state is **OPEN**.
    cl_facade -> tb_client : //Transfer// posting requested via the CL-TB interface.
    tb_client -> tb_nodes : //transfer// Distributed to nodes\n via the state machine.
    tb_nodes -> tb_nodes : Replication via VSR.
    tb_client - -> cl_facade : //transfer// posting create error **(none)**.
    cl_facade -> cl_db : Create \n*//transferFulfilment// \n*//transferStateChange// \nDatabase records.
    cl_facade -> cl_db : Database transaction committed.
    cl_facade - -> cl_domain : Return result.
    cl_domain - -> cl_handler : Return result.
    cl_handler - -> cl_api : Return result.
    cl_api - -> dfsp : Return result.
end
@enduml

PlantUML version 1.2022.4beta2(Unknown compile time)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>